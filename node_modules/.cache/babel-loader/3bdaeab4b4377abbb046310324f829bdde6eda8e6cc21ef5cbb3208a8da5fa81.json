{"ast":null,"code":"import{createSlice,createAsyncThunk}from\"@reduxjs/toolkit\";import{fetchArticlesAPI}from\"../../api/apiClient\";// Thunk asincrono per fetch degli articoli\nexport const fetchArticles=createAsyncThunk(\"articles/fetchArticles\",async(query,thunkAPI)=>{try{var _data$response,_data$response$docs;const response=await fetchArticlesAPI(query);const data=response.data;// Mappatura sicura dei documenti degli articoli\nreturn((_data$response=data.response)===null||_data$response===void 0?void 0:(_data$response$docs=_data$response.docs)===null||_data$response$docs===void 0?void 0:_data$response$docs.map(doc=>{var _doc$headline$main,_doc$headline,_doc$multimedia,_doc$snippet;return{id:doc._id,title:(_doc$headline$main=(_doc$headline=doc.headline)===null||_doc$headline===void 0?void 0:_doc$headline.main)!==null&&_doc$headline$main!==void 0?_doc$headline$main:\"Nessun titolo trovato\",url:doc.web_url,multimedia:(_doc$multimedia=doc.multimedia)!==null&&_doc$multimedia!==void 0?_doc$multimedia:[],snippet:(_doc$snippet=doc.snippet)!==null&&_doc$snippet!==void 0?_doc$snippet:\"\"};}))||[];}catch(error){var _error$response,_error$response$data;// Se l'errore contiene response e message, passa quello\nconst errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message||\"Errore nella ricerca articoli.\";return thunkAPI.rejectWithValue(errorMessage);}});const articlesSlice=createSlice({name:\"articles\",initialState:{query:\"\",articles:[],loading:false,error:null,selectedArticle:null},reducers:{setQuery(state,action){state.query=action.payload;},setSelectedArticle(state,action){state.selectedArticle=action.payload;}},extraReducers:builder=>{builder.addCase(fetchArticles.pending,state=>{state.loading=true;state.error=null;}).addCase(fetchArticles.fulfilled,(state,action)=>{state.loading=false;state.articles=action.payload;}).addCase(fetchArticles.rejected,(state,action)=>{state.loading=false;state.error=action.payload||\"Errore durante il recupero dei dati.\";});}});export const{setQuery,setSelectedArticle}=articlesSlice.actions;export default articlesSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","fetchArticlesAPI","fetchArticles","query","thunkAPI","_data$response","_data$response$docs","response","data","docs","map","doc","_doc$headline$main","_doc$headline","_doc$multimedia","_doc$snippet","id","_id","title","headline","main","url","web_url","multimedia","snippet","error","_error$response","_error$response$data","errorMessage","message","rejectWithValue","articlesSlice","name","initialState","articles","loading","selectedArticle","reducers","setQuery","state","action","payload","setSelectedArticle","extraReducers","builder","addCase","pending","fulfilled","rejected","actions","reducer"],"sources":["/workspaces/progetto-react-di-Andrea-Altomare/src/features/articles/ articlesSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { fetchArticlesAPI } from \"../../api/apiClient\";\n\n// Thunk asincrono per fetch degli articoli\nexport const fetchArticles = createAsyncThunk(\n  \"articles/fetchArticles\",\n  async (query, thunkAPI) => {\n    try {\n      const response = await fetchArticlesAPI(query);\n      const data = response.data;\n\n      // Mappatura sicura dei documenti degli articoli\n      return (\n        data.response?.docs?.map((doc) => ({\n          id: doc._id,\n          title: doc.headline?.main ?? \"Nessun titolo trovato\",\n          url: doc.web_url,\n          multimedia: doc.multimedia ?? [],\n          snippet: doc.snippet ?? \"\",\n        })) || []\n      );\n    } catch (error) {\n      // Se l'errore contiene response e message, passa quello\n      const errorMessage =\n        error.response?.data?.message ||\n        error.message ||\n        \"Errore nella ricerca articoli.\";\n      return thunkAPI.rejectWithValue(errorMessage);\n    }\n  }\n);\n\nconst articlesSlice = createSlice({\n  name: \"articles\",\n  initialState: {\n    query: \"\",\n    articles: [],\n    loading: false,\n    error: null,\n    selectedArticle: null,\n  },\n  reducers: {\n    setQuery(state, action) {\n      state.query = action.payload;\n    },\n    setSelectedArticle(state, action) {\n      state.selectedArticle = action.payload;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchArticles.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(fetchArticles.fulfilled, (state, action) => {\n        state.loading = false;\n        state.articles = action.payload;\n      })\n      .addCase(fetchArticles.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload || \"Errore durante il recupero dei dati.\";\n      });\n  },\n});\n\nexport const { setQuery, setSelectedArticle } = articlesSlice.actions;\nexport default articlesSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}